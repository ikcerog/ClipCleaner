<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paste Cleaner ‚Äî Clean & Highlight</title>
  <meta name="description" content="Paste messy copy from the frontend; prune ads/boilerplate, strip captions/credits (including duplicates) and sidebar CTAs, normalize spacing, keep bullets, and auto-highlight key bits."/>
  <style>
    :root{
      --bg:#0f0f12;
      --card:#17171b;
      --muted:#9aa0a6;
      --text:#f2f4f8;
      --brand:#7c5cff;
      --chip:#121218;
      --border:rgba(255,255,255,.1);
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --card:#ffffff;
      --muted:#5f6b7b;
      --text:#0e1116;
      --brand:#6b4dff;
      --chip:#f1f2f6;
      --border:rgba(16,24,40,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    }

    header{
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter:saturate(180%) blur(6px);
      background:linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,0));
    }
    .head-inner{
      max-width:980px;
      margin:0 auto;
      padding:16px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .title{font-size:22px; font-weight:800; letter-spacing:.2px}
    .sub{color:var(--muted); font-size:14px}
    .head-text{display:flex; flex-direction:column; gap:2px}
    .flex{flex:1}
    .toggle{
      margin-left:auto;
      display:inline-flex;
      gap:8px;
      align-items:center;
      border:1px solid var(--border);
      background:var(--card);
      color:var(--text);
      padding:8px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
    }

    .app{
      max-width:980px;
      margin:16px auto 80px;
      padding:0 16px;
      display:grid;
      gap:16px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius:16px;
      box-shadow:0 8px 40px rgba(0,0,0,.35);
    }
    .pad{padding:16px}

    textarea{
      width:100%;
      min-height:180px;
      background:var(--card);
      color:var(--text);
      border:1px dashed var(--border);
      border-radius:12px;
      padding:12px;
      font:14px/1.45 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }
    .hint{color:var(--muted); font-size:13px}

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    button{
      appearance:none;
      border:1px solid var(--border);
      background:var(--brand);
      color:white;
      padding:10px 14px;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      font-size:14px;
    }
    button.secondary{
      background:transparent;
      color:var(--text);
    }
    button:disabled{opacity:.6; cursor:not-allowed}

    .section-title{font-size:16px; font-weight:800; margin:0 0 8px}
    .list{padding-left:18px; margin:0}
    .list li{margin-bottom:4px;}

    .key-entities{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
      background:var(--chip);
      font-size:13px;
    }

    .metrics{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      color:var(--muted);
      font-size:14px;
      margin-top:8px;
    }
    .pill{
      background:transparent;
      color:var(--muted);
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
    }

    .article{
      line-height:1.8; /* ‚âà10% extra vertical space */
      font-family:"WNTL", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    .article h1, .article h2, .article h3{line-height:1.2}
    .article h1{font-size:24px; margin:4px 0 10px; font-family:"WNTL", inherit}
    .article h2{font-size:20px; margin:14px 0 8px; font-family:"WNTL", inherit}
    .article h3{font-size:18px; margin:12px 0 6px; font-family:"WNTL", inherit}
    .article p{
      margin:14px 0;
      font-family:"WNTL", inherit;
    }
    .article img, .article figure, .article iframe{display:none !important}
    .article a{
      color:#c9c200;
      text-decoration:none;
      border-bottom:1px dotted rgba(255,255,0,.7);
    }
    .article .byline{
      font-size:14px;
      color:var(--muted);
      margin:4px 0 10px;
      font-style:italic;
    }
    .article ul{
      margin:10px 0 14px 1.25em;
      padding-left:1.25em;
    }
    .article li{
      margin:3px 0;
      font-family:"WNTL", inherit;
    }

    /* Yellow highlight, per request: rgba(255,255,0,0.8) */
    .hl{
      background:rgba(255,255,0,0.8);
      border-radius:4px;
      padding:0 2px;
    }

    .hidden{display:none !important}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/compromise@14.14.1/builds/compromise.min.js"></script>
</head>
<body>
  <header>
    <div class="head-inner">
      <div class="head-text">
        <div class="title">Paste Cleaner ‚Äî Clean & Highlight</div>
        <div class="sub">Paste messy copy from a media site; we‚Äôll prune junk, drop captions & sidebar CTAs, normalize bylines, keep bullets, and surface highlights.</div>
      </div>
      <div class="flex"></div>
      <button id="modeToggle" class="toggle" aria-label="Toggle color mode">üåô Dark</button>
    </div>
  </header>

  <main class="app">
    <section class="card pad">
      <label class="hint" for="text">Paste messy frontend copy here (Ctrl/Cmd+V):</label>
      <textarea id="text" placeholder="Paste raw article copy here‚Ä¶"></textarea>
      <div class="controls">
        <button id="btnProcess">Clean & Highlight</button>
        <button id="btnDemo" class="secondary">Load Example</button>
        <span id="stats" class="hint"></span>
      </div>
    </section>

    <section class="card pad">
      <div class="section-title">Highlights</div>
      <ul id="highlights" class="list"></ul>
      <div id="entitiesWrap" class="key-entities hidden" aria-label="Key entities"></div>
      <div class="metrics" id="metrics"></div>
    </section>

    <section class="card pad">
      <div class="section-title">Cleaned Output</div>
      <article id="article" class="article"></article>
    </section>
  </main>

  <script>
    const $ = (s,r=document)=>r.querySelector(s);
    const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

    /* --- Light/Dark toggle --- */
    const root = document.documentElement;
    const toggleBtn = $('#modeToggle');
    function syncToggleLabel(){
      toggleBtn.textContent = root.getAttribute('data-theme') === 'light' ? '‚òÄÔ∏è Light' : 'üåô Dark';
    }
    toggleBtn.addEventListener('click', ()=>{
      root.setAttribute('data-theme', root.getAttribute('data-theme') === 'light' ? 'dark' : 'light');
      syncToggleLabel();
    });
    syncToggleLabel();

    /* --- Demo text --- */
    const DEMO = `Real Estate

GM Plans to Overhaul Detroit's Iconic Towers. A Battle Is Brewing With Taxpayers.

The $1.6 billion proposal calls for $350 million in public subsidies

By
Peter Grant and Someone Else

Dec. 17, 2024 5:30 am ET

General Motors and billionaire developer Daniel Gilbert are planning to overhaul downtown Detroit's iconic office complex Renaissance Center.

Newsletter Sign-up

What's News

Catch up on the headlines, understand the news and make better decisions, free in your inbox daily. Enjoy a free article in every edition.

Preview

Key points:
‚Ä¢ GM and Daniel Gilbert plan a $1.6 billion overhaul of Renaissance Center.
‚Ä¢ The proposal includes $350 million in public subsidies.
‚Ä¢ Supporters say the project would modernize an aging complex.

More details:
1. City officials are weighing the tax impact.
2. Community groups want stronger guarantees on jobs.
3. The plan includes mixed-use retail and public spaces.

The 5.5 million-square-foot complex was named Renaissance Center to symbolize the rebirth of Detroit.
The 5.5 million-square-foot complex was named Renaissance Center to symbolize the rebirth of Detroit. Ryan Garza/Zuma Press.

A conceptual rendering of the proposed Renaissance Center redevelopment in Detroit.
A conceptual rendering of the proposed Renaissance Center redevelopment in Detroit. Bedrock/GENSLER DETROIT

GM is seeking public subsidies to help fund the overhaul, which has drawn both support and criticism from local stakeholders.

Subscribe for more market news >>
Disclaimer & DisclosureReport an Issue`;

    $('#btnDemo').addEventListener('click', ()=>{
      $('#text').value = DEMO;
      runTextClean();
    });

    $('#btnProcess').addEventListener('click', runTextClean);

    function runTextClean(){
      const raw = $('#text').value || '';
      const result = prunePastedText(raw);
      const cleaned = result.text;
      const removedLines = result.removed;

      const artEl = $('#article');
      artEl.innerHTML = '';

      if (!cleaned){
        artEl.innerHTML = '<p class="hint">Nothing to show yet. Paste some copy and hit ‚ÄúClean & Highlight‚Äù.</p>';
        renderHighlights('', artEl, removedLines);
        return;
      }

      // Split into logical blocks (paragraph-ish units)
      let blocks = cleaned.split(/\n{2,}/).map(function(b){ return b.trim(); }).filter(Boolean);

      // ---- Byline normalization ----
      let byline = null;
      let consumed = new Array(blocks.length).fill(false);

      function normalizeByline(name){
        name = name.replace(/^By\s+/i,'').trim();
        name = name.replace(/\s*\.+$/,''); // strip trailing dots
        return 'By ' + name + '.';
      }

      for (let i=0; i<Math.min(blocks.length,6); i++){
        const b = blocks[i];
        if (!b) continue;

        // Case: "By Name Here..."
        if (/^By\s+.+/i.test(b)){
          byline = normalizeByline(b);
          consumed[i] = true;
          break;
        }

        // Case: "By" then next line has names
        if (/^By\s*$/i.test(b) && i+1 < blocks.length){
          const b2 = blocks[i+1].trim();
          if (b2 && b2.length < 80 && /^[A-Za-z0-9 .,&'‚Äô-]+$/.test(b2)){
            byline = normalizeByline(b2);
            consumed[i] = true;
            consumed[i+1] = true;
            break;
          }
        }
      }

      // Remove consumed (byline) blocks from the main flow
      const newBlocks = [];
      for (let i=0; i<blocks.length; i++){
        if (!consumed[i]) newBlocks.push(blocks[i]);
      }
      if (!newBlocks.length){
        artEl.innerHTML = '<p class="hint">Content removed as boilerplate.</p>';
        renderHighlights('', artEl, removedLines);
        return;
      }

      // ---- Title detection (avoid promoting section labels like "REAL ESTATE") ----
      function isSectionLabel(t){
        const txt = t.trim();
        if (!txt) return false;
        if (/[.!?]$/.test(txt)) return false;
        const words = txt.split(/\s+/);
        // 1‚Äì3 short words, no punctuation = likely section label
        if (words.length <= 3 && txt.length <= 24) return true;
        return false;
      }

      let titleIndex = -1;
      for (let i=0; i<Math.min(newBlocks.length,8); i++){
        const t = newBlocks[i];
        if (!t) continue;
        if (isSectionLabel(t)) continue;
        if (/^By\b/i.test(t)) continue;
        const wc = t.split(/\s+/).length;
        const len = t.length;
        if (len >= 25 || wc >= 5){
          titleIndex = i;
          break;
        }
      }
      if (titleIndex === -1) titleIndex = 0;

      // Pre-title blocks (e.g., "REAL ESTATE") remain as plain text, not big headline
      const preBlocks = newBlocks.slice(0, titleIndex);
      renderBlocksAsBody(preBlocks, artEl);

      // Title as H1
      const titleText = newBlocks[titleIndex];
      if (titleText){
        const h = document.createElement('h1');
        h.textContent = titleText;
        artEl.appendChild(h);
      }

      // Byline (single-line)
      if (byline){
        const bp = document.createElement('p');
        bp.className = 'byline';
        bp.textContent = byline;
        artEl.appendChild(bp);
      }

      // Remaining blocks after title
      const restBlocks = newBlocks.slice(titleIndex + 1);
      renderBlocksAsBody(restBlocks, artEl);

      const plain = (artEl.textContent||'').replace(/\s+/g,' ').trim();
      renderHighlights(plain, artEl, removedLines);
    }

    // Render paragraph blocks, but keep bullets as real lists
    function renderBlocksAsBody(blocks, container){
      let i = 0;
      function isBullet(t){
        const txt = t.trim();
        if (!txt) return false;
        if (/^(\u2022|‚Ä¢|\*|-|\u2013|\u2014)\s+.+/.test(txt)) return true; // ‚Ä¢ item, - item, * item
        if (/^\d+\.\s+.+/.test(txt)) return true; // 1. item
        if (/^[A-Za-z]\)\s+.+/.test(txt)) return true; // a) item
        return false;
      }
      function stripBulletPrefix(t){
        return t.trim()
          .replace(/^(\u2022|‚Ä¢|\*|-|\u2013|\u2014)\s+/, '')
          .replace(/^\d+\.\s+/, '')
          .replace(/^[A-Za-z]\)\s+/, '')
          .trim();
      }

      while (i < blocks.length){
        const blk = blocks[i];
        if (!blk){ i++; continue; }

        if (isBullet(blk)){
          const ul = document.createElement('ul');
          while (i < blocks.length && isBullet(blocks[i])){
            const li = document.createElement('li');
            li.textContent = stripBulletPrefix(blocks[i]);
            ul.appendChild(li);
            i++;
          }
          container.appendChild(ul);
        } else {
          const p = document.createElement('p');
          p.textContent = blk;
          container.appendChild(p);
          i++;
        }
      }
    }

    function renderHighlights(plain, artEl, removedLines){
      const bullets = summarizeSentences(plain, 5);
      const hl = $('#highlights'); hl.innerHTML='';
      bullets.forEach(function(b){
        const li = document.createElement('li');
        li.textContent = b;
        hl.appendChild(li);
      });

      const nlp = window.nlp || (function(){ return function(){ return { people:()=>({out:()=>[]}), organizations:()=>({out:()=>[]}), places:()=>({out:()=>[]}) }; };})();
      const docN = nlp(plain);
      const ents = dedupe([
        ...(docN.people().out('array')||[]),
        ...(docN.organizations().out('array')||[]),
        ...(docN.places().out('array')||[])
      ]).slice(0,12);

      const wrap = $('#entitiesWrap'); wrap.innerHTML='';
      if (ents.length){
        wrap.classList.remove('hidden');
        ents.forEach(function(e){
          const chip = document.createElement('span');
          chip.className = 'chip';
          chip.textContent = e;
          wrap.appendChild(chip);
        });
      } else {
        wrap.classList.add('hidden');
      }

      autoInlineHighlights(artEl, ents.slice(0,6));

      const wc = (plain.match(/\b\w+\b/g)||[]).length;
      const captionCount = prunePastedText._lastCaptionCount || 0;
      const foundGraphics = !!prunePastedText._foundGraphics;

      $('#metrics').innerHTML =
        '<span class="pill">Words: ' + wc.toLocaleString() + '</span>' +
        ' <span class="pill">Sentences: ' + ((plain.split(/[.!?]\s/).length)||0) + '</span>' +
        ' <span class="pill">Entities: ' + ents.length + '</span>' +
        ' <span class="pill">Lines removed: ' + removedLines + '</span>' +
        ' <span class="pill">Captions removed: ' + captionCount + '</span>' +
        (foundGraphics ? ' <span class="pill">Graphics detected</span>' : '');
    }

    /* ---------- Caption/CTA cleaner ---------- */
    function prunePastedText(input){
      if (!input) return { text:'', removed:0 };

      var s = input
        .replace(/\r/g,'')
        .replace(/[‚Äò‚Äô]/g,"'")
        .replace(/[‚Äú‚Äù]/g,'"')
        .replace(/\u00A0/g,' ')
        .replace(/\t/g,' ');

      var rawLines = s.split(/\n+/).map(function(l){ return l.trim(); }).filter(Boolean);
      var n = rawLines.length;
      if (!n) return { text:'', removed:0 };

      var drop = new Array(n);
      var normKey = new Array(n);
      var captionish = new Array(n);

      var agencyRx = /(Getty Images|Reuters|AP\b|Associated Press|Bloomberg|AFP|Agence France\-Presse|USA TODAY NETWORK|Shutterstock|iStock|WireImage|Press|EPA\b|Zuma Press|GENSLER DETROIT)/i;
      var captionWordRx = /(\bphoto\b|\bimage\b|\bcaption\b|\bcredit\b|pictured|conceptual rendering|artist'?s rendering|file photo|rendering)/i;

      // Generic junk + newsletter/sidebar CTAs
      var dropRx = [
        /^(advertising|advertisement|ad|sponsored)\b/i,
        /black\s*friday|cyber\s*monday|sale|discount|sign up|subscribe|try premium/i,
        /read\s*more\b|see\s+.*>>\s*$/i,
        /disclaimer|disclosure|report an issue/i,
        /cookies|privacy policy|terms of service/i,
        /this article contains syndicated content/i,

        // Sidebar / newsletter CTAs
        /newsletter\s*sign[- ]?up/i,
        /\bnewsletter\b/i,
        /\bwhat'?s news\b/i,
        /catch up on the headlines/i,
        /free in your inbox daily/i,
        /in your inbox daily/i,
        /free article in every edition/i,
        /enjoy a free article/i,
        /sign up for .*newsletter/i,
        /\byour inbox\b/i,
        /^preview$/i
      ];

      function stripInlineCredits(t){
        return t
          .replace(/\s*\((?:photo|image|getty|reuters|ap|associated press|afp|bloomberg|usa today network|zuma press)[^)]*\)\s*/ig,' ')
          .replace(/\s*\[(?:photo|image)[^\]]*\]\s*/ig,' ')
          .replace(/[\s\-‚Äì‚Äî]*[A-Za-z'\.\s]+\/(?:[A-Z][A-Za-z&\s]+|AP|AFP|EPA|Reuters|Bloomberg|Getty Images|Zuma Press|GENSLER DETROIT)\.?$/i,'')
          .replace(/\s{2,}/g,' ')
          .trim();
      }
      function keyOf(t){
        return stripInlineCredits(t)
          .toLowerCase()
          .replace(/\.(?:\s*[A-Z][A-Z\/-]{2,}\b.*)?$/, '.')
          .replace(/[-‚Äì‚Äî]\s*[A-Z][A-Z\/-]{2,}\b.*/, '')
          .replace(/\s+/g,' ')
          .trim();
      }

      var i;

      // Pass 1: classify
      for (i=0;i<n;i++){
        var line = rawLines[i];

        if (dropRx.some(function(rx){ return rx.test(line); })){
          drop[i] = true;
          continue;
        }

        var len = line.length;
        var shortish = len <= 220;

        var isCaptionish =
          shortish &&
          (captionWordRx.test(line) ||
           agencyRx.test(line) ||
           /^(a|an|the)\s+(conceptual|artist'?s)\b/i.test(line));

        captionish[i] = isCaptionish;

        if (shortish && len >= 15){
          normKey[i] = keyOf(line);
        } else {
          normKey[i] = null;
        }
      }

      // Pass 2: duplicate short lines
      var map = Object.create(null);
      for (i=0;i<n;i++){
        if (drop[i] || !normKey[i]) continue;
        var k = normKey[i];
        if (!k) continue;
        if (!map[k]) map[k] = [];
        map[k].push(i);
      }

      var removed = 0;
      var captionsRemoved = 0;
      var graphicsFlag = false;

      Object.keys(map).forEach(function(k){
        var idxs = map[k];
        if (idxs.length >= 2){
          idxs.forEach(function(idx){
            if (!drop[idx]){
              drop[idx] = true;
              removed++;
              captionsRemoved++;
            }
          });
        }
      });

      // Pass 3: single caption-ish lines
      for (i=0;i<n;i++){
        if (drop[i]) continue;
        if (captionish[i]){
          drop[i] = true;
          removed++;
          captionsRemoved++;
        }
      }

      graphicsFlag = captionsRemoved > 0;

      // Pass 4: build kept lines
      var kept = [];
      for (i=0;i<n;i++){
        if (drop[i]) continue;
        var line = rawLines[i];

        line = stripInlineCredits(line);
        line = line.replace(/\b([A-Z][A-Za-z]+)\s*-\s*\1\b/, '$1');
        line = line.replace(/(\d)(am|pm)/ig, function(m,d,ap){ return d + ' ' + ap.toUpperCase(); });
        line = line.replace(/\s{2,}/g,' ').trim();
        if (!line){ removed++; continue; }

        kept.push(line);
      }

      var out = kept.join('\n\n').replace(/\n\n(?:Disclaimer.*|Disclosure.*)$/i,'').trim();

      prunePastedText._lastCaptionCount = captionsRemoved;
      prunePastedText._foundGraphics = graphicsFlag;
      return { text: out, removed: removed };
    }

    /* ---------- NLP helpers ---------- */
    function summarizeSentences(text, k){
      if (!text) return [];
      var sents = text.match(/[^.!?]+[.!?]/g) || [text];
      var stop = new Set('a,an,the,and,or,but,if,in,into,on,for,from,of,at,by,to,with,as,is,are,was,were,be,been,being,that,this,these,those,about,than,then,so,it,its,their,his,her,they,them,we,our,you,your,i,me,my,not,no,will,would,can,could,should,over,under,between,within,without,up,down,more,most,very'.split(','));
      var freq = Object.create(null);
      sents.forEach(function(s){
        s.toLowerCase().replace(/[^a-z0-9\s]/g,' ').split(/\s+/).forEach(function(w){
          if (w && !stop.has(w)) freq[w] = (freq[w]||0)+1;
        });
      });
      var scored = sents.map(function(s,idx){
        var words = s.toLowerCase().replace(/[^a-z0-9\s]/g,' ').split(/\s+/);
        var score = 0;
        words.forEach(function(w){ if (freq[w]) score += freq[w]; });
        score += Math.max(0, (sents.length - idx)) * 0.01;
        return { s:s.trim(), score:score };
      });
      scored.sort(function(a,b){ return b.score - a.score; });
      return scored.slice(0,k).map(function(o){ return o.s; });
    }

    function dedupe(arr){
      var seen = new Set(), out = [];
      arr.forEach(function(v){
        var k = String(v).toLowerCase();
        if (!seen.has(k)){ seen.add(k); out.push(v); }
      });
      return out;
    }

    function autoInlineHighlights(container, terms){
      if (!terms || !terms.length) return;
      var walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null);
      var nodes = [];
      while (walker.nextNode()) nodes.push(walker.currentNode);
      var rx = new RegExp('\\b(' + terms.map(escapeRegex).join('|') + ')\\b','gi');
      nodes.forEach(function(n){
        if (!n.nodeValue || !rx.test(n.nodeValue)) return;
        var span = document.createElement('span');
        span.innerHTML = n.nodeValue.replace(rx, '<span class="hl">$1</span>');
        n.parentNode.replaceChild(span, n);
      });
    }

    function escapeRegex(s){ return s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }
  </script>
</body>
</html>
